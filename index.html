<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Southern Prayer Times</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root {
            --blue-header: #007bff;
            --bg-gray: #f2f4f7;
            --white: #ffffff;
            --text-dark: #333;
        }

        body {
            font-family: 'Kanit', sans-serif;
            background-color: var(--bg-gray);
            margin: 0;
            display: flex;
            justify-content: center;
            padding: 20px;
        }

        .main-app {
            width: 100%;
            max-width: 450px;
            background: var(--white);
            border-radius: 25px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            overflow: hidden;
            text-align: center;
        }

        /* Header สีฟ้าตามรูป */
        .header-banner {
            background-color: var(--blue-header);
            color: white;
            padding: 25px;
            font-family: 'Amiri', serif;
            font-size: 2.5rem;
            font-weight: bold;
        }

        .date-status {
            padding: 15px;
            background: #fff;
            display: flex;
            justify-content: center;
            gap: 15px;
            font-size: 0.95rem;
            color: #555;
            border-bottom: 1px solid #eee;
        }

        .hijri-section {
            padding: 10px;
            background: #eef5ff;
            color: var(--blue-header);
            font-weight: 600;
            font-size: 1.1rem;
        }

        .location-picker {
            padding: 20px;
        }

        select {
            font-family: 'Kanit';
            padding: 10px 15px;
            border-radius: 12px;
            border: 1px solid #ddd;
            width: 80%;
            font-size: 1rem;
            outline: none;
        }

        /* รายการการ์ดเวลาละหมาด */
        .prayer-list {
            padding: 0 20px 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .prayer-card {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 25px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.06);
            border: 1px solid #f0f2f5;
        }

        .prayer-name-group {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .prayer-name-group i { font-size: 1.4rem; width: 25px; }
        
        /* ฟอนต์อาหรับ Amiri */
        .ar-name {
            font-family: 'Amiri', serif;
            font-size: 1.6rem;
            font-weight: bold;
            color: var(--text-dark);
        }

        .time-val {
            font-size: 1.6rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        /* สีพิเศษสำหรับ Shurooq ตามรูป */
        .card-shurooq {
            background: linear-gradient(to right, #ff758c, #ff7eb3);
            border: none;
            color: white;
        }
        .card-shurooq .ar-name, .card-shurooq .time-val { color: white; }

        /* สีไอคอน */
        .fajr i { color: #5c6bc0; }
        .dhuhr i { color: #fbc02d; }
        .asr i { color: #29b6f6; }
        .maghrib i { color: #ef5350; }
        .isha i { color: #3f51b5; }

        .footer-note {
            font-size: 0.85rem;
            color: #888;
            padding: 15px;
            background: #fafafa;
        }

        /* ระบบ Admin */
        .admin-btn { font-size: 0.7rem; color: #ddd; cursor: pointer; padding: 10px; }
        
        .admin-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.98); z-index: 1000;
            flex-direction: column; align-items: center; padding: 40px 20px; box-sizing: border-box;
            overflow-y: auto;
        }

        .admin-modal h2 { color: var(--blue-header); margin-bottom: 20px; }
        .input-group { margin-bottom: 15px; width: 100%; max-width: 320px; text-align: left; }
        .input-group label { display: block; font-size: 0.9rem; margin-bottom: 5px; color: #666; }
        .input-group input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; box-sizing: border-box; font-family: 'Kanit'; }

        .btn-action {
            width: 100%; max-width: 320px; padding: 12px; border: none; border-radius: 10px;
            background: var(--blue-header); color: white; font-weight: bold; cursor: pointer; margin-top: 10px;
        }
    </style>
</head>
<body>

<div class="main-app">
    <div class="header-banner">أوقات الصلاة</div>
    
    <div class="date-status">
        <span><i class="far fa-calendar"></i> <span id="thDate">-- -- ----</span></span>
        <span><i class="far fa-clock"></i> <span id="thClock">00:00:00</span></span>
    </div>

    <div class="hijri-section" id="hijriDisplay">-- --- ----</div>

    <div class="location-picker">
        <label style="font-size: 0.8rem; color: #888;">เลือกจังหวัด:</label><br>
        <select id="citySelect" onchange="updateView()">
            <option value="ยะลา">ยะลา</option>
            <option value="นครศรีธรรมราช">นครศรีธรรมราช / พัทลุง</option>
            <option value="จะนะ">จะนะ / เทพา</option>
            <option value="สตูล">สตูล</option>
            <option value="ตรัง">ตรัง</option>
            <option value="ปัตตานี">ปัตตานี</option>
            <option value="นราธิวาส">นราธิวาส</option>
            <option value="สุไหงโกลก">สุไหงโกลก</option>
        </select>
    </div>

    <div class="prayer-list" id="prayerDisplay">
        </div>

    <div class="footer-note" id="footerMsg">ตารางเวลานี้ใช้เฉพาะจังหวัดยะลา</div>
    
    <div class="admin-btn" onclick="openLogin()">ADMIN LOGIN</div>
</div>

<div id="adminModal" class="admin-modal">
    <h2 id="adminTitle">Admin Login</h2>
    
    <div id="loginSection">
        <input type="password" id="adminPass" placeholder="รหัสผ่านแอดมิน" style="padding:12px; width:260px; border-radius:10px; border:1px solid #ccc;">
        <button class="btn-action" onclick="checkAuth()">เข้าสู่ระบบ</button>
        <button class="btn-action" style="background:#666" onclick="closeAdmin()">ปิด</button>
    </div>

    <div id="setupSection" style="display:none; width: 100%; max-width: 350px;">
        <h4 style="margin:0 0 10px; color:#555;">1. ตั้งเวลาละหมาด (ยะลา)</h4>
        <div id="adminTimeFields"></div>
        
        <h4 style="margin:20px 0 10px; color:#555;">2. ตั้งวันที่อิสลาม</h4>
        <div class="input-group">
            <input type="text" id="hijriEdit" placeholder="เช่น 29 ชะอ์บาน 1445">
        </div>

        <button class="btn-action" onclick="saveSettings()">บันทึกทั้งหมด</button>
        <button class="btn-action" style="background:#666" onclick="closeAdmin()">ยกเลิก</button>
    </div>
</div>

<script>
    // รหัสผ่านตามสั่ง
    const SECRET_KEY = "17851902";

    const offsets = {
        'ยะลา': 0, 'นครศรีธรรมราช': 3, 'จะนะ': 1, 'สตูล': 2, 'ตรัง': 4, 'ปัตตานี': -2, 'นราธิวาส': -4, 'สุไหงโกลก': -5
    };

    const prayers = [
        { id: 'fajr', ar: 'فجر', icon: 'fa-moon', cls: 'fajr' },
        { id: 'shurooq', ar: 'شروق', icon: 'fa-cloud-sun', cls: 'card-shurooq' },
        { id: 'dhuhr', ar: 'ظهر', icon: 'fa-sun', cls: 'dhuhr' },
        { id: 'asr', ar: 'عصر', icon: 'fa-cloud', cls: 'asr' },
        { id: 'maghrib', ar: 'مغرب', icon: 'fa-cloud-moon', cls: 'maghrib' },
        { id: 'isha', ar: 'عشاء', icon: 'fa-moon', cls: 'isha' }
    ];

    // ข้อมูลเริ่มต้น
    let baseData = JSON.parse(localStorage.getItem('prayerAppDB')) || {
        times: { fajr: "05:16", shurooq: "06:28", dhuhr: "12:31", asr: "15:51", maghrib: "18:32", isha: "19:40" },
        hijri: "29 ชะอ์บาน 1445"
    };

    function addMins(timeStr, mins) {
        let [h, m] = timeStr.split(':').map(Number);
        let d = new Date();
        d.setHours(h, m + mins, 0);
        return d.toLocaleTimeString('th-TH', { hour: '2-digit', minute: '2-digit', hour12: false });
    }

    function updateView() {
        const city = document.getElementById('citySelect').value;
        const offset = offsets[city];
        const display = document.getElementById('prayerDisplay');
        const footer = document.getElementById('footerMsg');
        
        document.getElementById('hijriDisplay').innerText = baseData.hijri;
        footer.innerText = city === 'ยะลา' ? 'ตารางเวลานี้ใช้เฉพาะจังหวัดยะลา' : `ระบบคำนวณส่วนต่างสำหรับ ${city} แล้ว`;
        
        display.innerHTML = '';
        prayers.forEach(p => {
            const finalTime = addMins(baseData.times[p.id], offset);
            display.innerHTML += `
                <div class="prayer-card ${p.cls}">
                    <div class="prayer-name-group">
                        <i class="fas ${p.icon}"></i>
                        <span class="ar-name">${p.ar}</span>
                    </div>
                    <div class="time-val">${finalTime}</div>
                </div>
            `;
        });
    }

    // --- ระบบแอดมิน ---
    function openLogin() {
        document.getElementById('adminModal').style.display = 'flex';
        document.getElementById('loginSection').style.display = 'block';
        document.getElementById('setupSection').style.display = 'none';
        document.getElementById('adminTitle').innerText = "Admin Login";
    }

    function checkAuth() {
        if(document.getElementById('adminPass').value === SECRET_KEY) {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('setupSection').style.display = 'block';
            document.getElementById('adminTitle').innerText = "Settings";
            
            const fields = document.getElementById('adminTimeFields');
            fields.innerHTML = '';
            prayers.forEach(p => {
                fields.innerHTML += `
                    <div class="input-group">
                        <label>${p.id.toUpperCase()} (ยะลา):</label>
                        <input type="time" id="set-${p.id}" value="${baseData.times[p.id]}">
                    </div>
                `;
            });
            document.getElementById('hijriEdit').value = baseData.hijri;
        } else { alert("รหัสผ่านไม่ถูกต้อง!"); }
    }

    function saveSettings() {
        prayers.forEach(p => {
            baseData.times[p.id] = document.getElementById(`set-${p.id}`).value;
        });
        baseData.hijri = document.getElementById('hijriEdit').value;
        localStorage.setItem('prayerAppDB', JSON.stringify(baseData));
        alert("บันทึกข้อมูลสำเร็จ!");
        closeAdmin();
        updateView();
    }

    function closeAdmin() { 
        document.getElementById('adminModal').style.display = 'none';
        document.getElementById('adminPass').value = '';
    }

    function tick() {
        const now = new Date();
        document.getElementById('thClock').innerText = now.toLocaleTimeString('th-TH');
        document.getElementById('thDate').innerText = now.toLocaleDateString('th-TH', { day: 'numeric', month: 'long', year: 'numeric' });
    }

    setInterval(tick, 1000);
    tick();
    updateView();
</script>

</body>
</html>
